{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport PropTypes from 'prop-types';\nimport isUndefined from 'lodash/isUndefined';\nimport debounce from 'lodash/debounce';\nimport InfiniteList from \"../infinite-list\";\nimport XDate from 'xdate';\nimport React, { useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { useDidUpdate } from \"../hooks\";\nimport { getMoment } from \"../momentResolver\";\nimport { isGTE, isToday } from \"../dateutils\";\nimport { getDefaultLocale } from \"../services\";\nimport { UpdateSources, todayString } from \"./commons\";\nimport styleConstructor from \"./style\";\nimport Context from \"./Context\";\nimport constants from \"../commons/constants\";\nimport { parseDate } from \"../interface\";\nimport { LayoutProvider } from \"recyclerlistview/dist/reactnative/core/dependencies/LayoutProvider\";\nimport { AgendaSectionHeader } from \"./agendaList\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nvar InfiniteAgendaList = function InfiniteAgendaList(props) {\n  var _sections$, _infiniteListProps$vi;\n\n  var theme = props.theme,\n      sections = props.sections,\n      scrollToNextEvent = props.scrollToNextEvent,\n      avoidDateUpdates = props.avoidDateUpdates,\n      onScroll = props.onScroll,\n      renderSectionHeader = props.renderSectionHeader,\n      sectionStyle = props.sectionStyle,\n      dayFormatter = props.dayFormatter,\n      _props$dayFormat = props.dayFormat,\n      dayFormat = _props$dayFormat === void 0 ? 'dddd, MMM d' : _props$dayFormat,\n      useMoment = props.useMoment,\n      _props$markToday = props.markToday,\n      markToday = _props$markToday === void 0 ? true : _props$markToday,\n      infiniteListProps = props.infiniteListProps,\n      renderItem = props.renderItem,\n      onEndReached = props.onEndReached,\n      onEndReachedThreshold = props.onEndReachedThreshold,\n      refreshControl = props.refreshControl;\n\n  var _useContext = useContext(Context),\n      date = _useContext.date,\n      updateSource = _useContext.updateSource,\n      setDate = _useContext.setDate;\n\n  var style = useRef(styleConstructor(theme));\n  var list = useRef();\n\n  var _topSection = useRef((_sections$ = sections[0]) == null ? void 0 : _sections$.title);\n\n  var didScroll = useRef(false);\n  var sectionScroll = useRef(false);\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var dataRef = useRef(data);\n  useEffect(function () {\n    var items = sections.reduce(function (acc, cur) {\n      return [].concat(_toConsumableArray(acc), [{\n        title: cur.title,\n        isTitle: true\n      }], _toConsumableArray(cur.data));\n    }, []);\n    setData(items);\n    dataRef.current = items;\n\n    if (date !== _topSection.current) {\n      setTimeout(function () {\n        scrollToSection(date);\n      }, 500);\n    }\n  }, [sections]);\n  useDidUpdate(function () {\n    if (updateSource !== UpdateSources.LIST_DRAG && updateSource !== UpdateSources.CALENDAR_INIT) {\n      scrollToSection(date);\n    }\n  }, [date]);\n\n  var getSectionIndex = function getSectionIndex(date) {\n    var dataIndex = 0;\n\n    for (var i = 0; i < sections.length; i++) {\n      if (sections[i].title === date) {\n        return dataIndex;\n      }\n\n      dataIndex += sections[i].data.length + 1;\n    }\n  };\n\n  var getNextSectionIndex = function getNextSectionIndex(date) {\n    var cur = new XDate(date);\n    var dataIndex = 0;\n\n    for (var i = 0; i < sections.length; i++) {\n      var titleDate = parseDate(sections[i].title);\n\n      if (isGTE(titleDate, cur)) {\n        return dataIndex;\n      }\n\n      dataIndex += sections[i].data.length + 1;\n    }\n  };\n\n  var getSectionTitle = useCallback(function (title) {\n    if (!title) return;\n    var sectionTitle = title;\n\n    if (dayFormatter) {\n      sectionTitle = dayFormatter(title);\n    } else if (dayFormat) {\n      if (useMoment) {\n        var moment = getMoment();\n        sectionTitle = moment(title).format(dayFormat);\n      } else {\n        sectionTitle = new XDate(title).toString(dayFormat);\n      }\n    }\n\n    if (markToday) {\n      var string = getDefaultLocale().today || todayString;\n      var today = isToday(title);\n      sectionTitle = today ? `${string}, ${sectionTitle}` : sectionTitle;\n    }\n\n    return sectionTitle;\n  }, []);\n  var scrollToSection = useCallback(debounce(function (requestedDate) {\n    var sectionIndex = scrollToNextEvent ? getNextSectionIndex(requestedDate) : getSectionIndex(requestedDate);\n\n    if (isUndefined(sectionIndex)) {\n      return;\n    }\n\n    if (list != null && list.current && sectionIndex !== undefined) {\n      sectionScroll.current = true;\n\n      if (requestedDate !== _topSection.current) {\n        var _sections$findItemTit, _list$current;\n\n        _topSection.current = (_sections$findItemTit = sections[findItemTitleIndex(sectionIndex)]) == null ? void 0 : _sections$findItemTit.title;\n        (_list$current = list.current) == null ? void 0 : _list$current.scrollToIndex(sectionIndex, true);\n      }\n\n      setTimeout(function () {\n        _onMomentumScrollEnd();\n      }, 500);\n    }\n  }, 1000, {\n    leading: false,\n    trailing: true\n  }), [sections]);\n  var layoutProvider = useMemo(function () {\n    return new LayoutProvider(function (index) {\n      var _dataRef$current$inde;\n\n      return (_dataRef$current$inde = dataRef.current[index]) != null && _dataRef$current$inde.isTitle ? 'title' : 'page';\n    }, function (type, dim) {\n      var _infiniteListProps$ti, _infiniteListProps$it;\n\n      dim.width = constants.screenWidth;\n      dim.height = type === 'title' ? (_infiniteListProps$ti = infiniteListProps == null ? void 0 : infiniteListProps.titleHeight) != null ? _infiniteListProps$ti : 60 : (_infiniteListProps$it = infiniteListProps == null ? void 0 : infiniteListProps.itemHeight) != null ? _infiniteListProps$it : 80;\n    });\n  }, []);\n\n  var _onScroll = useCallback(function (rawEvent) {\n    if (!didScroll.current) {\n      didScroll.current = true;\n      scrollToSection.cancel();\n    }\n\n    var event = {\n      nativeEvent: {\n        contentOffset: rawEvent.nativeEvent.contentOffset,\n        layoutMeasurement: rawEvent.nativeEvent.layoutMeasurement,\n        contentSize: rawEvent.nativeEvent.contentSize\n      }\n    };\n    onScroll == null ? void 0 : onScroll(event);\n  }, [onScroll]);\n\n  var _onVisibleIndicesChanged = useCallback(debounce(function (all) {\n    if (all && all.length && !sectionScroll.current) {\n      var topItemIndex = all[0];\n      var topSection = data[findItemTitleIndex(topItemIndex)];\n\n      if (topSection && topSection !== _topSection.current) {\n        _topSection.current = topSection.title;\n\n        if (didScroll.current && !avoidDateUpdates) {\n          setDate == null ? void 0 : setDate(topSection.title, UpdateSources.LIST_DRAG);\n        }\n      }\n    }\n  }, (_infiniteListProps$vi = infiniteListProps == null ? void 0 : infiniteListProps.visibleIndicesChangedDebounce) != null ? _infiniteListProps$vi : 1000, {\n    leading: false,\n    trailing: true\n  }), [avoidDateUpdates, setDate, data]);\n\n  var findItemTitleIndex = useCallback(function (itemIndex) {\n    var titleIndex = itemIndex;\n\n    while (titleIndex > 0 && !((_data$titleIndex = data[titleIndex]) != null && _data$titleIndex.isTitle)) {\n      var _data$titleIndex;\n\n      titleIndex--;\n    }\n\n    return titleIndex;\n  }, [data]);\n\n  var _onMomentumScrollEnd = useCallback(function () {\n    sectionScroll.current = false;\n  }, []);\n\n  var headerTextStyle = useMemo(function () {\n    return [style.current.sectionText, sectionStyle];\n  }, [sectionStyle]);\n\n  var _renderSectionHeader = useCallback(function (info) {\n    var _info$section;\n\n    var title = info == null ? void 0 : (_info$section = info.section) == null ? void 0 : _info$section.title;\n\n    if (renderSectionHeader) {\n      return renderSectionHeader(title);\n    }\n\n    var headerTitle = getSectionTitle(title);\n    return _jsx(AgendaSectionHeader, {\n      title: headerTitle,\n      style: headerTextStyle\n    });\n  }, [headerTextStyle]);\n\n  var _renderItem = useCallback(function (_type, item) {\n    if (item != null && item.isTitle) {\n      return _renderSectionHeader({\n        section: item\n      });\n    }\n\n    if (renderItem) {\n      return renderItem({\n        item: item\n      });\n    }\n\n    return _jsx(_Fragment, {});\n  }, [renderItem]);\n\n  var _onEndReached = useCallback(function () {\n    if (onEndReached) {\n      onEndReached({\n        distanceFromEnd: 0\n      });\n    }\n  }, [onEndReached]);\n\n  return _jsx(InfiniteList, {\n    ref: list,\n    renderItem: _renderItem,\n    data: data,\n    style: style.current.container,\n    layoutProvider: layoutProvider,\n    onScroll: _onScroll,\n    onVisibleIndicesChanged: _onVisibleIndicesChanged,\n    scrollViewProps: {\n      onMomentumScrollEnd: _onMomentumScrollEnd,\n      nestedScrollEnabled: true,\n      refreshControl: refreshControl\n    },\n    onEndReached: _onEndReached,\n    onEndReachedThreshold: onEndReachedThreshold,\n    disableScrollOnDataChange: true,\n    renderFooter: infiniteListProps == null ? void 0 : infiniteListProps.renderFooter\n  });\n};\n\nexport default InfiniteAgendaList;\nInfiniteAgendaList.displayName = 'InfiniteAgendaList';\nInfiniteAgendaList.propTypes = {\n  dayFormat: PropTypes.string,\n  dayFormatter: PropTypes.func,\n  useMoment: PropTypes.bool,\n  markToday: PropTypes.bool,\n  sectionStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.array]),\n  avoidDateUpdates: PropTypes.bool\n};","map":{"version":3,"names":["PropTypes","isUndefined","debounce","InfiniteList","XDate","React","useCallback","useContext","useEffect","useMemo","useRef","useState","useDidUpdate","getMoment","isGTE","isToday","getDefaultLocale","UpdateSources","todayString","styleConstructor","Context","constants","parseDate","LayoutProvider","AgendaSectionHeader","InfiniteAgendaList","props","theme","sections","scrollToNextEvent","avoidDateUpdates","onScroll","renderSectionHeader","sectionStyle","dayFormatter","dayFormat","useMoment","markToday","infiniteListProps","renderItem","onEndReached","onEndReachedThreshold","refreshControl","date","updateSource","setDate","style","list","_topSection","title","didScroll","sectionScroll","data","setData","dataRef","items","reduce","acc","cur","isTitle","current","setTimeout","scrollToSection","LIST_DRAG","CALENDAR_INIT","getSectionIndex","dataIndex","i","length","getNextSectionIndex","titleDate","getSectionTitle","sectionTitle","moment","format","toString","string","today","requestedDate","sectionIndex","undefined","findItemTitleIndex","scrollToIndex","_onMomentumScrollEnd","leading","trailing","layoutProvider","index","type","dim","width","screenWidth","height","titleHeight","itemHeight","_onScroll","rawEvent","cancel","event","nativeEvent","contentOffset","layoutMeasurement","contentSize","_onVisibleIndicesChanged","all","topItemIndex","topSection","visibleIndicesChangedDebounce","itemIndex","titleIndex","headerTextStyle","sectionText","_renderSectionHeader","info","section","headerTitle","_renderItem","_type","item","_onEndReached","distanceFromEnd","container","onMomentumScrollEnd","nestedScrollEnabled","renderFooter","displayName","propTypes","func","bool","oneOfType","object","number","array"],"sources":["/Users/atsushi/Dev/baby/node_modules/react-native-calendars/src/expandableCalendar/infiniteAgendaList.js"],"sourcesContent":["import PropTypes from 'prop-types';\nimport isUndefined from 'lodash/isUndefined';\nimport debounce from 'lodash/debounce';\nimport InfiniteList from '../infinite-list';\nimport XDate from 'xdate';\nimport React, { useCallback, useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport { useDidUpdate } from '../hooks';\nimport { getMoment } from '../momentResolver';\nimport { isGTE, isToday } from '../dateutils';\nimport { getDefaultLocale } from '../services';\nimport { UpdateSources, todayString } from './commons';\nimport styleConstructor from './style';\nimport Context from './Context';\nimport constants from \"../commons/constants\";\nimport { parseDate } from \"../interface\";\nimport { LayoutProvider } from \"recyclerlistview/dist/reactnative/core/dependencies/LayoutProvider\";\nimport { AgendaSectionHeader } from \"./agendaList\";\n/**\n * @description: AgendaList component that use InfiniteList to improve performance\n * @note: Should be wrapped with 'CalendarProvider'\n * @extends: InfiniteList\n * @example: https://github.com/wix/react-native-calendars/blob/master/example/src/screens/expandableCalendar.js\n */\nconst InfiniteAgendaList = (props) => {\n    const { theme, sections, scrollToNextEvent, avoidDateUpdates, onScroll, renderSectionHeader, sectionStyle, dayFormatter, dayFormat = 'dddd, MMM d', useMoment, markToday = true, infiniteListProps, renderItem, onEndReached, onEndReachedThreshold, refreshControl } = props;\n    const { date, updateSource, setDate } = useContext(Context);\n    const style = useRef(styleConstructor(theme));\n    const list = useRef();\n    const _topSection = useRef(sections[0]?.title);\n    const didScroll = useRef(false);\n    const sectionScroll = useRef(false);\n    const [data, setData] = useState([]);\n    const dataRef = useRef(data);\n    useEffect(() => {\n        const items = sections.reduce((acc, cur) => {\n            return [...acc, { title: cur.title, isTitle: true }, ...cur.data];\n        }, []);\n        setData(items);\n        dataRef.current = items;\n        if (date !== _topSection.current) {\n            setTimeout(() => {\n                scrollToSection(date);\n            }, 500);\n        }\n    }, [sections]);\n    useDidUpdate(() => {\n        // NOTE: on first init data should set first section to the current date!!!\n        if (updateSource !== UpdateSources.LIST_DRAG && updateSource !== UpdateSources.CALENDAR_INIT) {\n            scrollToSection(date);\n        }\n    }, [date]);\n    const getSectionIndex = (date) => {\n        let dataIndex = 0;\n        for (let i = 0; i < sections.length; i++) {\n            if (sections[i].title === date) {\n                return dataIndex;\n            }\n            dataIndex += sections[i].data.length + 1;\n        }\n    };\n    const getNextSectionIndex = (date) => {\n        const cur = new XDate(date);\n        let dataIndex = 0;\n        for (let i = 0; i < sections.length; i++) {\n            const titleDate = parseDate(sections[i].title);\n            if (isGTE(titleDate, cur)) {\n                return dataIndex;\n            }\n            dataIndex += sections[i].data.length + 1;\n        }\n    };\n    const getSectionTitle = useCallback((title) => {\n        if (!title)\n            return;\n        let sectionTitle = title;\n        if (dayFormatter) {\n            sectionTitle = dayFormatter(title);\n        }\n        else if (dayFormat) {\n            if (useMoment) {\n                const moment = getMoment();\n                sectionTitle = moment(title).format(dayFormat);\n            }\n            else {\n                sectionTitle = new XDate(title).toString(dayFormat);\n            }\n        }\n        if (markToday) {\n            const string = getDefaultLocale().today || todayString;\n            const today = isToday(title);\n            sectionTitle = today ? `${string}, ${sectionTitle}` : sectionTitle;\n        }\n        return sectionTitle;\n    }, []);\n    const scrollToSection = useCallback(debounce((requestedDate) => {\n        const sectionIndex = scrollToNextEvent ? getNextSectionIndex(requestedDate) : getSectionIndex(requestedDate);\n        if (isUndefined(sectionIndex)) {\n            return;\n        }\n        if (list?.current && sectionIndex !== undefined) {\n            sectionScroll.current = true; // to avoid setDate() in _onVisibleIndicesChanged\n            if (requestedDate !== _topSection.current) {\n                _topSection.current = sections[findItemTitleIndex(sectionIndex)]?.title;\n                list.current?.scrollToIndex(sectionIndex, true);\n            }\n            setTimeout(() => {\n                _onMomentumScrollEnd(); // the RecyclerListView doesn't trigger onMomentumScrollEnd when calling scrollToSection\n            }, 500);\n        }\n    }, 1000, { leading: false, trailing: true }), [sections]);\n    const layoutProvider = useMemo(() => new LayoutProvider((index) => dataRef.current[index]?.isTitle ? 'title' : 'page', (type, dim) => {\n        dim.width = constants.screenWidth;\n        dim.height = type === 'title' ? infiniteListProps?.titleHeight ?? 60 : infiniteListProps?.itemHeight ?? 80;\n    }), []);\n    const _onScroll = useCallback((rawEvent) => {\n        if (!didScroll.current) {\n            didScroll.current = true;\n            scrollToSection.cancel();\n        }\n        // Convert to a format similar to NativeSyntheticEvent<NativeScrollEvent>\n        const event = {\n            nativeEvent: {\n                contentOffset: rawEvent.nativeEvent.contentOffset,\n                layoutMeasurement: rawEvent.nativeEvent.layoutMeasurement,\n                contentSize: rawEvent.nativeEvent.contentSize,\n            },\n        };\n        onScroll?.(event);\n    }, [onScroll]);\n    const _onVisibleIndicesChanged = useCallback(debounce((all) => {\n        if (all && all.length && !sectionScroll.current) {\n            const topItemIndex = all[0];\n            const topSection = data[findItemTitleIndex(topItemIndex)];\n            if (topSection && topSection !== _topSection.current) {\n                _topSection.current = topSection.title;\n                if (didScroll.current && !avoidDateUpdates) {\n                    // to avoid setDate() on first load (while setting the initial context.date value)\n                    setDate?.(topSection.title, UpdateSources.LIST_DRAG);\n                }\n            }\n        }\n    }, infiniteListProps?.visibleIndicesChangedDebounce ?? 1000, { leading: false, trailing: true }), [avoidDateUpdates, setDate, data]);\n    const findItemTitleIndex = useCallback((itemIndex) => {\n        let titleIndex = itemIndex;\n        while (titleIndex > 0 && !data[titleIndex]?.isTitle) {\n            titleIndex--;\n        }\n        return titleIndex;\n    }, [data]);\n    const _onMomentumScrollEnd = useCallback(() => {\n        sectionScroll.current = false;\n    }, []);\n    const headerTextStyle = useMemo(() => [style.current.sectionText, sectionStyle], [sectionStyle]);\n    const _renderSectionHeader = useCallback((info) => {\n        const title = info?.section?.title;\n        if (renderSectionHeader) {\n            return renderSectionHeader(title);\n        }\n        const headerTitle = getSectionTitle(title);\n        return <AgendaSectionHeader title={headerTitle} style={headerTextStyle}/>;\n    }, [headerTextStyle]);\n    const _renderItem = useCallback((_type, item) => {\n        if (item?.isTitle) {\n            return _renderSectionHeader({ section: item });\n        }\n        if (renderItem) {\n            return renderItem({ item });\n        }\n        return <></>;\n    }, [renderItem]);\n    const _onEndReached = useCallback(() => {\n        if (onEndReached) {\n            onEndReached({ distanceFromEnd: 0 }); // The RecyclerListView doesn't provide the distanceFromEnd, so we just pass 0\n        }\n    }, [onEndReached]);\n    return (<InfiniteList ref={list} renderItem={_renderItem} data={data} style={style.current.container} layoutProvider={layoutProvider} onScroll={_onScroll} onVisibleIndicesChanged={_onVisibleIndicesChanged} scrollViewProps={{ onMomentumScrollEnd: _onMomentumScrollEnd, nestedScrollEnabled: true, refreshControl }} onEndReached={_onEndReached} onEndReachedThreshold={onEndReachedThreshold} disableScrollOnDataChange renderFooter={infiniteListProps?.renderFooter}/>);\n};\nexport default InfiniteAgendaList;\nInfiniteAgendaList.displayName = 'InfiniteAgendaList';\nInfiniteAgendaList.propTypes = {\n    dayFormat: PropTypes.string,\n    dayFormatter: PropTypes.func,\n    useMoment: PropTypes.bool,\n    markToday: PropTypes.bool,\n    sectionStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.array]),\n    avoidDateUpdates: PropTypes.bool\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
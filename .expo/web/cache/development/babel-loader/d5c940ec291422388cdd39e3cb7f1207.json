{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction e(e, t, n, r, i, a, s) {\n  try {\n    var o = e[a](s),\n        c = o.value;\n  } catch (e) {\n    return void n(e);\n  }\n\n  o.done ? t(c) : Promise.resolve(c).then(r, i);\n}\n\nfunction t(e, t) {\n  if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n}\n\nfunction n(e, t) {\n  for (var n = 0; n < t.length; n++) {\n    var r = t[n];\n    r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n  }\n}\n\nfunction r(e, t, n) {\n  return t in e ? Object.defineProperty(e, t, {\n    value: n,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[t] = n, e;\n}\n\nfunction i(e) {\n  for (var t = 1; t < arguments.length; t++) {\n    var n = null != arguments[t] ? arguments[t] : {},\n        i = Object.keys(n);\n    \"function\" == typeof Object.getOwnPropertySymbols && (i = i.concat(Object.getOwnPropertySymbols(n).filter(function (e) {\n      return Object.getOwnPropertyDescriptor(n, e).enumerable;\n    }))), i.forEach(function (t) {\n      r(e, t, n[t]);\n    });\n  }\n\n  return e;\n}\n\nfunction a(e, t) {\n  if (\"function\" != typeof t && null !== t) throw new TypeError(\"Super expression must either be null or a function\");\n  e.prototype = Object.create(t && t.prototype, {\n    constructor: {\n      value: e,\n      writable: !0,\n      configurable: !0\n    }\n  }), t && o(e, t);\n}\n\nfunction s(e) {\n  return (s = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {\n    return e.__proto__ || Object.getPrototypeOf(e);\n  })(e);\n}\n\nfunction o(e, t) {\n  return (o = Object.setPrototypeOf || function (e, t) {\n    return e.__proto__ = t, e;\n  })(e, t);\n}\n\nfunction c(e, t, n) {\n  return (c = function () {\n    if (\"undefined\" == typeof Reflect || !Reflect.construct) return !1;\n    if (Reflect.construct.sham) return !1;\n    if (\"function\" == typeof Proxy) return !0;\n\n    try {\n      return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;\n    } catch (e) {\n      return !1;\n    }\n  }() ? Reflect.construct : function (e, t, n) {\n    var r = [null];\n    r.push.apply(r, t);\n    var i = new (Function.bind.apply(e, r))();\n    return n && o(i, n.prototype), i;\n  }).apply(null, arguments);\n}\n\nfunction u(e) {\n  var t = \"function\" == typeof Map ? new Map() : void 0;\n  return (u = function u(e) {\n    if (null === e || (n = e, -1 === Function.toString.call(n).indexOf(\"[native code]\"))) return e;\n    var n;\n    if (\"function\" != typeof e) throw new TypeError(\"Super expression must either be null or a function\");\n\n    if (void 0 !== t) {\n      if (t.has(e)) return t.get(e);\n      t.set(e, r);\n    }\n\n    function r() {\n      return c(e, arguments, s(this).constructor);\n    }\n\n    return r.prototype = Object.create(e.prototype, {\n      constructor: {\n        value: r,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    }), o(r, e);\n  })(e);\n}\n\nfunction h(e, t) {\n  return !t || \"object\" != typeof t && \"function\" != typeof t ? function (e) {\n    if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    return e;\n  }(e) : t;\n}\n\nvar l = function (e) {\n  function n(e) {\n    var r;\n    return t(this, n), (r = h(this, s(n).call(this, \"Not Found! Params: \".concat(e)))).name = \"NotFoundError\", r.stack = new Error().stack, r;\n  }\n\n  return a(n, u(Error)), n;\n}(),\n    f = function (e) {\n  function n(e) {\n    var r;\n    return t(this, n), (r = h(this, s(n).call(this, \"Expired! Params: \".concat(e)))).name = \"ExpiredError\", r.stack = new Error().stack, r;\n  }\n\n  return a(n, u(Error)), n;\n}();\n\nexport default (function () {\n  function r() {\n    var e = this,\n        n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};\n    if (t(this, r), this._SIZE = n.size || 1e3, this.sync = n.sync || {}, this.defaultExpires = void 0 !== n.defaultExpires ? n.defaultExpires : 864e5, this.enableCache = !1 !== n.enableCache, this._s = n.storageBackend || null, this._innerVersion = 11, this.cache = {}, this._s && this._s.setItem) try {\n      var i = this._s.setItem(\"__react_native_storage_test\", \"test\");\n\n      this.isPromise = !(!i || !i.then);\n    } catch (e) {\n      throw console.warn(e), delete this._s, e;\n    } else console.warn(\"Data would be lost after reload cause there is no storageBackend specified!\\n      \\nEither use localStorage(for web) or AsyncStorage(for React Native) as a storageBackend.\");\n    this._mapPromise = this.getItem(\"map\").then(function (t) {\n      e._m = e._checkMap(t && JSON.parse(t) || {});\n    });\n  }\n\n  var a, s, o, c, u;\n  return a = r, (s = [{\n    key: \"getItem\",\n    value: function value(e) {\n      return this._s ? this.isPromise ? this._s.getItem(e) : Promise.resolve(this._s.getItem(e)) : Promise.resolve();\n    }\n  }, {\n    key: \"setItem\",\n    value: function value(e, t) {\n      return this._s ? this.isPromise ? this._s.setItem(e, t) : Promise.resolve(this._s.setItem(e, t)) : Promise.resolve();\n    }\n  }, {\n    key: \"removeItem\",\n    value: function value(e) {\n      return this._s ? this.isPromise ? this._s.removeItem(e) : Promise.resolve(this._s.removeItem(e)) : Promise.resolve();\n    }\n  }, {\n    key: \"_initMap\",\n    value: function value() {\n      return {\n        innerVersion: this._innerVersion,\n        index: 0,\n        __keys__: {}\n      };\n    }\n  }, {\n    key: \"_checkMap\",\n    value: function value(e) {\n      return e && e.innerVersion && e.innerVersion === this._innerVersion ? e : this._initMap();\n    }\n  }, {\n    key: \"_getId\",\n    value: function value(e, t) {\n      return e + \"_\" + t;\n    }\n  }, {\n    key: \"_saveToMap\",\n    value: function value(e) {\n      var t = e.key,\n          n = e.id,\n          r = e.data,\n          i = this._getId(t, n),\n          a = this._m;\n\n      if (void 0 !== a[i]) return this.enableCache && (this.cache[i] = JSON.parse(r)), this.setItem(\"map_\" + a[i], r);\n\n      if (void 0 !== a[a.index]) {\n        var s = a[a.index],\n            o = s.split(\"_\");\n        delete a[s], this._removeIdInKey(o[0], o[1]), this.enableCache && delete this.cache[s];\n      }\n\n      if (a[i] = a.index, a[a.index] = i, a.__keys__[t] = a.__keys__[t] || [], a.__keys__[t].push(n), this.enableCache) {\n        var c = JSON.parse(r);\n        this.cache[i] = c;\n      }\n\n      var u = a.index;\n      ++a.index === this._SIZE && (a.index = 0), this.setItem(\"map_\" + u, r), this.setItem(\"map\", JSON.stringify(a));\n    }\n  }, {\n    key: \"save\",\n    value: function value(e) {\n      var t = this,\n          n = e.key,\n          r = e.id,\n          i = e.data,\n          a = e.rawData,\n          s = e.expires,\n          o = void 0 === s ? this.defaultExpires : s;\n      -1 !== n.toString().indexOf(\"_\") && console.error('Please do not use \"_\" in key!');\n      var c = {\n        rawData: i\n      };\n\n      if (void 0 === i) {\n        if (void 0 === a) return void console.error('\"data\" is required in save()!');\n        console.warn('\"rawData\" is deprecated, please use \"data\" instead!'), c.rawData = a;\n      }\n\n      var u = Date.now();\n\n      if (null !== o && (c.expires = u + o), c = JSON.stringify(c), void 0 === r) {\n        if (this.enableCache) {\n          var h = JSON.parse(c);\n          this.cache[n] = h;\n        }\n\n        return this.setItem(n, c);\n      }\n\n      return -1 !== r.toString().indexOf(\"_\") && console.error('Please do not use \"_\" in id!'), this._mapPromise.then(function () {\n        return t._saveToMap({\n          key: n,\n          id: r,\n          data: c\n        });\n      });\n    }\n  }, {\n    key: \"getBatchData\",\n    value: function value(e) {\n      var t = this;\n      return Promise.all(e.map(function (e) {\n        return t.load(e);\n      }));\n    }\n  }, {\n    key: \"getBatchDataWithIds\",\n    value: (c = _regeneratorRuntime.mark(function e(t) {\n      var n,\n          r,\n          i,\n          a,\n          s,\n          o,\n          c,\n          u,\n          h = this;\n      return _regeneratorRuntime.wrap(function (e) {\n        for (;;) switch (e.prev = e.next) {\n          case 0:\n            return n = t.key, r = t.ids, i = t.syncInBackground, a = t.syncParams, s = r.map(function (e) {\n              return h.load({\n                key: n,\n                id: e,\n                syncInBackground: i,\n                autoSync: !1,\n                batched: !0\n              });\n            }), e.next = 4, Promise.all(s);\n\n          case 4:\n            if (o = e.sent, c = [], o.forEach(function (e) {\n              void 0 !== e.syncId && c.push(e.syncId);\n            }), !c.length) {\n              e.next = 14;\n              break;\n            }\n\n            return e.next = 10, this.sync[n]({\n              id: c,\n              syncParams: a\n            });\n\n          case 10:\n            return u = e.sent, e.abrupt(\"return\", o.map(function (e) {\n              return e.syncId ? u.shift() : e;\n            }));\n\n          case 14:\n            return e.abrupt(\"return\", o);\n\n          case 15:\n          case \"end\":\n            return e.stop();\n        }\n      }, e, this);\n    }), u = function u() {\n      var t = this,\n          n = arguments;\n      return new Promise(function (r, i) {\n        var a = c.apply(t, n);\n\n        function s(t) {\n          e(a, r, i, s, o, \"next\", t);\n        }\n\n        function o(t) {\n          e(a, r, i, s, o, \"throw\", t);\n        }\n\n        s(void 0);\n      });\n    }, function (e) {\n      return u.apply(this, arguments);\n    })\n  }, {\n    key: \"_lookupGlobalItem\",\n    value: function value(e) {\n      var t = this,\n          n = e.key;\n      return this.enableCache && void 0 !== this.cache[n] ? this._loadGlobalItem(i({\n        ret: this.cache[n]\n      }, e)) : this.getItem(n).then(function (n) {\n        return t._loadGlobalItem(i({\n          ret: n\n        }, e));\n      });\n    }\n  }, {\n    key: \"_loadGlobalItem\",\n    value: function value(e) {\n      var t = e.key,\n          n = e.ret,\n          r = e.autoSync,\n          i = e.syncInBackground,\n          a = e.syncParams;\n\n      if (null == n) {\n        if (r && this.sync[t]) return this.sync[t]({\n          syncParams: a\n        });\n        throw new l(JSON.stringify(e));\n      }\n\n      \"string\" == typeof n && (n = JSON.parse(n), this.enableCache && (this.cache[t] = n));\n      var s = Date.now();\n\n      if (n.expires < s) {\n        if (r && this.sync[t]) {\n          if (i) {\n            try {\n              this.sync[t]({\n                syncParams: a,\n                syncInBackground: i\n              });\n            } catch (e) {}\n\n            return n.rawData;\n          }\n\n          return this.sync[t]({\n            syncParams: a,\n            syncInBackground: i\n          });\n        }\n\n        throw new f(JSON.stringify(e));\n      }\n\n      return n.rawData;\n    }\n  }, {\n    key: \"_noItemFound\",\n    value: function value(e) {\n      var t = e.key,\n          n = e.id,\n          r = e.autoSync,\n          i = e.syncParams;\n      if (this.sync[t]) return r ? this.sync[t]({\n        id: n,\n        syncParams: i\n      }) : {\n        syncId: n\n      };\n      throw new l(JSON.stringify(e));\n    }\n  }, {\n    key: \"_loadMapItem\",\n    value: function value(e) {\n      var t = e.ret,\n          n = e.key,\n          r = e.id,\n          i = e.autoSync,\n          a = e.batched,\n          s = e.syncInBackground,\n          o = e.syncParams;\n      if (null == t) return this._noItemFound(e);\n\n      if (\"string\" == typeof t) {\n        t = JSON.parse(t);\n\n        var c = e.key,\n            u = e.id,\n            h = this._getId(c, u);\n\n        this.enableCache && (this.cache[h] = t);\n      }\n\n      var l = Date.now();\n\n      if (t.expires < l) {\n        if (i && this.sync[n]) {\n          if (s) {\n            try {\n              this.sync[n]({\n                id: r,\n                syncParams: o,\n                syncInBackground: s\n              });\n            } catch (e) {}\n\n            return t.rawData;\n          }\n\n          return this.sync[n]({\n            id: r,\n            syncParams: o,\n            syncInBackground: s\n          });\n        }\n\n        if (a) return {\n          syncId: r\n        };\n        throw new f(JSON.stringify(e));\n      }\n\n      return t.rawData;\n    }\n  }, {\n    key: \"_lookUpInMap\",\n    value: function value(e) {\n      var t,\n          n = this,\n          r = this._m,\n          a = e.key,\n          s = e.id,\n          o = this._getId(a, s);\n\n      return this.enableCache && this.cache[o] ? (t = this.cache[o], this._loadMapItem(i({\n        ret: t\n      }, e))) : void 0 !== r[o] ? this.getItem(\"map_\" + r[o]).then(function (t) {\n        return n._loadMapItem(i({\n          ret: t\n        }, e));\n      }) : this._noItemFound(i({\n        ret: t\n      }, e));\n    }\n  }, {\n    key: \"remove\",\n    value: function value(e) {\n      var t = this;\n      return this._mapPromise.then(function () {\n        var n = t._m,\n            r = e.key,\n            i = e.id;\n        if (void 0 === i) return t.enableCache && t.cache[r] && delete t.cache[r], t.removeItem(r);\n\n        var a = t._getId(r, i);\n\n        if (void 0 !== n[a]) {\n          t.enableCache && t.cache[a] && delete t.cache[a], t._removeIdInKey(r, i);\n          var s = n[a];\n          return delete n[a], t.setItem(\"map\", JSON.stringify(n)), t.removeItem(\"map_\" + s);\n        }\n      });\n    }\n  }, {\n    key: \"_removeIdInKey\",\n    value: function value(e, t) {\n      var n = (this._m.__keys__[e] || []).indexOf(t);\n      -1 !== n && this._m.__keys__[e].splice(n, 1);\n    }\n  }, {\n    key: \"load\",\n    value: function value(e) {\n      var t = this,\n          n = e.key,\n          r = e.id,\n          i = e.autoSync,\n          a = void 0 === i || i,\n          s = e.syncInBackground,\n          o = void 0 === s || s,\n          c = e.syncParams,\n          u = e.batched;\n      return this._mapPromise.then(function () {\n        return void 0 === r ? t._lookupGlobalItem({\n          key: n,\n          autoSync: a,\n          syncInBackground: o,\n          syncParams: c\n        }) : t._lookUpInMap({\n          key: n,\n          id: r,\n          autoSync: a,\n          syncInBackground: o,\n          batched: u,\n          syncParams: c\n        });\n      });\n    }\n  }, {\n    key: \"clearAll\",\n    value: function value() {\n      this._s.clear && this._s.clear(), this._m = this._initMap();\n    }\n  }, {\n    key: \"clearMap\",\n    value: function value() {\n      var e = this;\n      return this.removeItem(\"map\").then(function () {\n        e.cache = {}, e._m = e._initMap();\n      });\n    }\n  }, {\n    key: \"clearMapForKey\",\n    value: function value(e) {\n      var t = this;\n      return this._mapPromise.then(function () {\n        var n = (t._m.__keys__[e] || []).map(function (n) {\n          return t.remove({\n            key: e,\n            id: n\n          });\n        });\n        return Promise.all(n);\n      });\n    }\n  }, {\n    key: \"getIdsForKey\",\n    value: function value(e) {\n      var t = this;\n      return this._mapPromise.then(function () {\n        return t._m.__keys__[e] || [];\n      });\n    }\n  }, {\n    key: \"getAllDataForKey\",\n    value: function value(e, t) {\n      var n = this;\n      return t = Object.assign({\n        syncInBackground: !0\n      }, t), this.getIdsForKey(e).then(function (r) {\n        var i = r.map(function (n) {\n          return {\n            key: e,\n            id: n,\n            syncInBackground: t.syncInBackground\n          };\n        });\n        return n.getBatchData(i);\n      });\n    }\n  }]) && n(a.prototype, s), o && n(a, o), r;\n})();","map":{"version":3,"sources":["../src/error.js","../src/storage.js"],"names":["NotFoundError","Error","message","name","stack","ExpiredError","options","_SIZE","size","sync","defaultExpires","undefined","enableCache","_s","storageBackend","_innerVersion","cache","this","setItem","promiseTest","isPromise","then","e","console","warn","_mapPromise","getItem","_this","_m","_checkMap","map","JSON","parse","key","Promise","resolve","value","removeItem","innerVersion","index","__keys__","_initMap","id","params","data","newId","_getId","m","oldId","splitOldId","split","_removeIdInKey","push","cacheData","currentIndex","stringify","rawData","expires","toString","indexOf","error","dataToSave","now","Date","_this2","_saveToMap","querys","all","_this3","load","query","ids","syncInBackground","syncParams","tasks","_this4","autoSync","batched","results","missingIds","forEach","syncId","length","syncData","shift","_loadGlobalItem","ret","_this5","_noItemFound","_loadMapItem","_this6","_this7","idTobeDeleted","indexTobeRemoved","splice","_this8","_lookupGlobalItem","_lookUpInMap","clear","_this9","_this10","remove","_this11","Object","assign","getIdsForKey","_this12","getBatchData"],"mappings":"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","sourcesContent":["/**\n * Created by sunny on 9/1/16.\n */\n\nexport class NotFoundError extends Error {\n  constructor(message) {\n    super(`Not Found! Params: ${message}`);\n    this.name = 'NotFoundError';\n    this.stack = new Error().stack; // Optional\n  }\n}\n// NotFoundError.prototype = Object.create(Error.prototype);\n\nexport class ExpiredError extends Error {\n  constructor(message) {\n    super(`Expired! Params: ${message}`);\n    this.name = 'ExpiredError';\n    this.stack = new Error().stack; // Optional\n  }\n}\n// ExpiredError.prototype = Object.create(Error.prototype);\n","/*\n *  local storage(web/react native) wrapper\n *  sunnylqm\n */\nimport { NotFoundError, ExpiredError } from './error';\n\nexport default class Storage {\n  constructor(options = {}) {\n    this._SIZE = options.size || 1000; // maximum capacity\n    this.sync = options.sync || {}; // remote sync method\n    this.defaultExpires = options.defaultExpires !== undefined ? options.defaultExpires : 1000 * 3600 * 24;\n    this.enableCache = options.enableCache !== false;\n    this._s = options.storageBackend || null;\n    this._innerVersion = 11;\n    this.cache = {};\n\n    if (this._s && this._s.setItem) {\n      try {\n        var promiseTest = this._s.setItem('__react_native_storage_test', 'test');\n        this.isPromise = !!(promiseTest && promiseTest.then);\n      } catch (e) {\n        console.warn(e);\n        delete this._s;\n        throw e;\n      }\n    } else {\n      console.warn(`Data would be lost after reload cause there is no storageBackend specified!\n      \\nEither use localStorage(for web) or AsyncStorage(for React Native) as a storageBackend.`);\n    }\n\n    this._mapPromise = this.getItem('map').then(map => {\n      this._m = this._checkMap((map && JSON.parse(map)) || {});\n    });\n  }\n  getItem(key) {\n    return this._s\n      ? this.isPromise\n        ? this._s.getItem(key)\n        : Promise.resolve(this._s.getItem(key))\n      : Promise.resolve();\n  }\n  setItem(key, value) {\n    return this._s\n      ? this.isPromise\n        ? this._s.setItem(key, value)\n        : Promise.resolve(this._s.setItem(key, value))\n      : Promise.resolve();\n  }\n  removeItem(key) {\n    return this._s\n      ? this.isPromise\n        ? this._s.removeItem(key)\n        : Promise.resolve(this._s.removeItem(key))\n      : Promise.resolve();\n  }\n  _initMap() {\n    return {\n      innerVersion: this._innerVersion,\n      index: 0,\n      __keys__: {},\n    };\n  }\n  _checkMap(map) {\n    if (map && map.innerVersion && map.innerVersion === this._innerVersion) {\n      return map;\n    } else {\n      return this._initMap();\n    }\n  }\n  _getId(key, id) {\n    return key + '_' + id;\n  }\n  _saveToMap(params) {\n    let { key, id, data } = params,\n      newId = this._getId(key, id),\n      m = this._m;\n    if (m[newId] !== undefined) {\n      // update existing data\n      if (this.enableCache) this.cache[newId] = JSON.parse(data);\n      return this.setItem('map_' + m[newId], data);\n    }\n    if (m[m.index] !== undefined) {\n      // loop over, delete old data\n      let oldId = m[m.index];\n      let splitOldId = oldId.split('_');\n      delete m[oldId];\n      this._removeIdInKey(splitOldId[0], splitOldId[1]);\n      if (this.enableCache) {\n        delete this.cache[oldId];\n      }\n    }\n    m[newId] = m.index;\n    m[m.index] = newId;\n\n    m.__keys__[key] = m.__keys__[key] || [];\n    m.__keys__[key].push(id);\n\n    if (this.enableCache) {\n      const cacheData = JSON.parse(data);\n      this.cache[newId] = cacheData;\n    }\n    let currentIndex = m.index;\n    if (++m.index === this._SIZE) {\n      m.index = 0;\n    }\n    this.setItem('map_' + currentIndex, data);\n    this.setItem('map', JSON.stringify(m));\n  }\n  save(params) {\n    const { key, id, data, rawData, expires = this.defaultExpires } = params;\n    if (key.toString().indexOf('_') !== -1) {\n      console.error('Please do not use \"_\" in key!');\n    }\n    let dataToSave = { rawData: data };\n    if (data === undefined) {\n      if (rawData !== undefined) {\n        console.warn('\"rawData\" is deprecated, please use \"data\" instead!');\n        dataToSave.rawData = rawData;\n      } else {\n        console.error('\"data\" is required in save()!');\n        return;\n      }\n    }\n    let now = Date.now();\n    if (expires !== null) {\n      dataToSave.expires = now + expires;\n    }\n    dataToSave = JSON.stringify(dataToSave);\n    if (id === undefined) {\n      if (this.enableCache) {\n        const cacheData = JSON.parse(dataToSave);\n        this.cache[key] = cacheData;\n      }\n      return this.setItem(key, dataToSave);\n    } else {\n      if (id.toString().indexOf('_') !== -1) {\n        console.error('Please do not use \"_\" in id!');\n      }\n      return this._mapPromise.then(() =>\n        this._saveToMap({\n          key,\n          id,\n          data: dataToSave,\n        }),\n      );\n    }\n  }\n  getBatchData(querys) {\n    return Promise.all(querys.map(query => this.load(query)));\n  }\n  async getBatchDataWithIds(params) {\n    let { key, ids, syncInBackground, syncParams } = params;\n    const tasks = ids.map(id =>\n      this.load({\n        key,\n        id,\n        syncInBackground,\n        autoSync: false,\n        batched: true,\n      }),\n    );\n    const results = await Promise.all(tasks);\n    const missingIds = [];\n    results.forEach(value => {\n      if (value.syncId !== undefined) {\n        missingIds.push(value.syncId);\n      }\n    });\n    if (missingIds.length) {\n      const syncData = await this.sync[key]({\n        id: missingIds,\n        syncParams,\n      });\n      return results.map(value => {\n        return value.syncId ? syncData.shift() : value;\n      });\n    } else {\n      return results;\n    }\n  }\n  _lookupGlobalItem(params) {\n    const { key } = params;\n    if (this.enableCache && this.cache[key] !== undefined) {\n      return this._loadGlobalItem({ ret: this.cache[key], ...params });\n    }\n    return this.getItem(key).then(ret => this._loadGlobalItem({ ret, ...params }));\n  }\n  _loadGlobalItem(params) {\n    let { key, ret, autoSync, syncInBackground, syncParams } = params;\n    if (ret === null || ret === undefined) {\n      if (autoSync && this.sync[key]) {\n        return this.sync[key]({ syncParams });\n      }\n      throw new NotFoundError(JSON.stringify(params));\n    }\n    if (typeof ret === 'string') {\n      ret = JSON.parse(ret);\n      if (this.enableCache) {\n        this.cache[key] = ret;\n      }\n    }\n    let now = Date.now();\n    if (ret.expires < now) {\n      if (autoSync && this.sync[key]) {\n        if (syncInBackground) {\n          try {\n            this.sync[key]({ syncParams, syncInBackground });\n          } catch (e) {\n            // avoid uncaught exception\n          }\n          return ret.rawData;\n        }\n        return this.sync[key]({ syncParams, syncInBackground });\n      }\n      throw new ExpiredError(JSON.stringify(params));\n    }\n    return ret.rawData;\n  }\n  _noItemFound(params) {\n    let { key, id, autoSync, syncParams } = params;\n    if (this.sync[key]) {\n      if (autoSync) {\n        return this.sync[key]({ id, syncParams });\n      }\n      return { syncId: id };\n    }\n    throw new NotFoundError(JSON.stringify(params));\n  }\n  _loadMapItem(params) {\n    let { ret, key, id, autoSync, batched, syncInBackground, syncParams } = params;\n    if (ret === null || ret === undefined) {\n      return this._noItemFound(params);\n    }\n    if (typeof ret === 'string') {\n      ret = JSON.parse(ret);\n      const { key, id } = params;\n      const newId = this._getId(key, id);\n      if (this.enableCache) {\n        this.cache[newId] = ret;\n      }\n    }\n    let now = Date.now();\n    if (ret.expires < now) {\n      if (autoSync && this.sync[key]) {\n        if (syncInBackground) {\n          try {\n            this.sync[key]({ id, syncParams, syncInBackground });\n          } catch (e) {\n            // avoid uncaught exception\n          }\n          return ret.rawData;\n        }\n        return this.sync[key]({ id, syncParams, syncInBackground });\n      }\n      if (batched) {\n        return { syncId: id };\n      }\n      throw new ExpiredError(JSON.stringify(params));\n    }\n    return ret.rawData;\n  }\n  _lookUpInMap(params) {\n    let ret;\n    const m = this._m;\n    const { key, id } = params;\n    const newId = this._getId(key, id);\n    if (this.enableCache && this.cache[newId]) {\n      ret = this.cache[newId];\n      return this._loadMapItem({ ret, ...params });\n    }\n    if (m[newId] !== undefined) {\n      return this.getItem('map_' + m[newId]).then(ret => this._loadMapItem({ ret, ...params }));\n    }\n    return this._noItemFound({ ret, ...params });\n  }\n  remove(params) {\n    return this._mapPromise.then(() => {\n      let m = this._m;\n      let { key, id } = params;\n\n      if (id === undefined) {\n        if (this.enableCache && this.cache[key]) {\n          delete this.cache[key];\n        }\n        return this.removeItem(key);\n      }\n      let newId = this._getId(key, id);\n\n      // remove existing data\n      if (m[newId] !== undefined) {\n        if (this.enableCache && this.cache[newId]) {\n          delete this.cache[newId];\n        }\n        this._removeIdInKey(key, id);\n        let idTobeDeleted = m[newId];\n        delete m[newId];\n        this.setItem('map', JSON.stringify(m));\n        return this.removeItem('map_' + idTobeDeleted);\n      }\n    });\n  }\n  _removeIdInKey(key, id) {\n    const indexTobeRemoved = (this._m.__keys__[key] || []).indexOf(id);\n    if (indexTobeRemoved !== -1) {\n      this._m.__keys__[key].splice(indexTobeRemoved, 1);\n    }\n  }\n  load(params) {\n    const { key, id, autoSync = true, syncInBackground = true, syncParams, batched } = params;\n    return this._mapPromise.then(() => {\n      if (id === undefined) {\n        return this._lookupGlobalItem({\n          key,\n          autoSync,\n          syncInBackground,\n          syncParams,\n        });\n      } else {\n        return this._lookUpInMap({\n          key,\n          id,\n          autoSync,\n          syncInBackground,\n          batched,\n          syncParams,\n        });\n      }\n    });\n  }\n  clearAll() {\n    this._s.clear && this._s.clear();\n    this._m = this._initMap();\n  }\n  clearMap() {\n    return this.removeItem('map').then(() => {\n      this.cache = {};\n      this._m = this._initMap();\n    });\n  }\n  clearMapForKey(key) {\n    return this._mapPromise.then(() => {\n      let tasks = (this._m.__keys__[key] || []).map(id => this.remove({ key, id }));\n      return Promise.all(tasks);\n    });\n  }\n  getIdsForKey(key) {\n    return this._mapPromise.then(() => {\n      return this._m.__keys__[key] || [];\n    });\n  }\n  getAllDataForKey(key, options) {\n    options = Object.assign({ syncInBackground: true }, options);\n    return this.getIdsForKey(key).then(ids => {\n      const querys = ids.map(id => ({ key, id, syncInBackground: options.syncInBackground }));\n      return this.getBatchData(querys);\n    });\n  }\n}\n"]},"metadata":{},"sourceType":"module"}